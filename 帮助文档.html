<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>交叉口交通流量流向可视化工具 - 使用帮助</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Microsoft YaHei", "SimHei", "SimSun", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .section h3 {
            color: #764ba2;
            font-size: 1.4em;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .section p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .section ul, .section ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }
        
        .section li {
            margin-bottom: 10px;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .warning {
            background: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .info {
            background: #d1ecf1;
            padding: 15px;
            border-left: 4px solid #17a2b8;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .step-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .step-box h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
        }
        
        .table-example {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .table-example th,
        .table-example td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .table-example th {
            background: #667eea;
            color: white;
        }
        
        .table-example tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #666;
            border-top: 1px solid #ddd;
        }
        
        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .toc h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .toc ul {
            list-style: none;
            margin-left: 0;
        }
        
        .toc a {
            color: #667eea;
            text-decoration: none;
            display: block;
            padding: 5px 0;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚦 交叉口交通流量流向可视化工具</h1>
            <p>使用帮助文档 v1.3</p>
        </div>
        
        <div class="content">
            <div class="toc">
                <h3>📑 目录</h3>
                <ul>
                    <li><a href="#intro">1. 软件简介</a></li>
                    <li><a href="#start">2. 快速开始</a></li>
                    <li><a href="#data">3. 数据输入</a></li>
                    <li><a href="#draw">4. 绘制流量图</a></li>
                    <li><a href="#file">5. 文件操作</a></li>
                    <li><a href="#types">6. 交叉口类型</a></li>
                    <li><a href="#faq">7. 常见问题</a></li>
                    <li><a href="#update">8. 版本更新</a></li>
                </ul>
            </div>
            
            <div class="section" id="intro">
                <h2>1. 软件简介</h2>
                <p>
                    <strong>交叉口交通流量流向可视化工具</strong>是一款专业的交通流量可视化工具，用于绘制交叉口的交通流量图。
                    软件支持3路、4路、5路、6路交叉口，可以直观地展示各方向的交通流量和流向关系。
                </p>
                <div class="info">
                    <strong>主要功能：</strong>
                    <ul>
                        <li>支持3-6路交叉口的流量绘制</li>
                        <li>自动计算进口和出口流量</li>
                        <li>可视化展示各流向的交通量</li>
                        <li>支持数据文件的保存和读取</li>
                    </ul>
                </div>
            </div>
            
            <div class="section" id="start">
                <h2>2. 快速开始</h2>
                
                <h3>2.1 启动软件</h3>
                <p>启动软件后，会弹出交叉口类型选择对话框：</p>
                <div class="step-box">
                    <h4>选择交叉口类型</h4>
                    <ul>
                        <li><strong>3路交叉口</strong> - 适用于T型或Y型交叉口</li>
                        <li><strong>4路交叉口</strong> - 适用于十字交叉口</li>
                        <li><strong>5路交叉口</strong> - 适用于五路交叉口</li>
                        <li><strong>6路交叉口</strong> - 适用于六路交叉口</li>
                        <li><strong>读取数据文件</strong> - 从已有文件加载数据</li>
                    </ul>
                </div>
                
                <h3>2.2 主界面介绍</h3>
                <p>选择交叉口类型后，进入主界面：</p>
                <ul>
                    <li><strong>数据表格</strong> - 显示各进口的数据输入框，窗口大小会根据交叉口路数自动调整</li>
                    <li><strong>新建文件</strong> - 创建新的交叉口数据表格（可选择3-6路）</li>
                    <li><strong>读取数据</strong> - 从文件加载数据</li>
                    <li><strong>清空数据</strong> - 清空所有输入框的数据</li>
                    <li><strong>保存数据</strong> - 保存当前数据到文件</li>
                    <li><strong>数据另存为</strong> - 将数据保存为新文件</li>
                    <li><strong>绘制流量图</strong> - 生成并显示流量图</li>
                    <li><strong>帮助</strong> - 打开本帮助文档</li>
                    <li><strong>关于</strong> - 查看软件信息</li>
                </ul>
                
                <div class="info">
                    <strong>💡 界面优化：</strong> v1.3版本对界面进行了美化，包括：
                    <ul>
                        <li>使用更适合屏幕显示的字体（思源黑体/微软雅黑）</li>
                        <li>现代化的扁平风格按钮和输入框</li>
                        <li>优化的颜色方案和间距布局</li>
                        <li>窗口大小自适应功能</li>
                    </ul>
                </div>
            </div>
            
            <div class="section" id="data">
                <h2>3. 数据输入</h2>
                
                <h3>3.1 数据表格说明</h3>
                <p>数据表格包含以下列：</p>
                <table class="table-example">
                    <tr>
                        <th>列名</th>
                        <th>说明</th>
                        <th>示例</th>
                    </tr>
                    <tr>
                        <td>进口编号</td>
                        <td>自动生成，不可编辑</td>
                        <td>进口1, 进口2, ...</td>
                    </tr>
                    <tr>
                        <td>进口名称</td>
                        <td>道路名称或方向名称</td>
                        <td>双龙大道, 天元路, 东, 南, 西, 北</td>
                    </tr>
                    <tr>
                        <td>方位角</td>
                        <td>进口方向角度（0-360度）</td>
                        <td>0, 90, 180, 270</td>
                    </tr>
                    <tr>
                        <td>流向数据</td>
                        <td>各流向的交通量（辆/小时）</td>
                        <td>100, 200, 150</td>
                    </tr>
                </table>
                
                <div class="highlight">
                    <strong>💡 提示：</strong> 方位角以正东方向为0度，逆时针增加。例如：
                    <ul>
                        <li>0度 = 正东</li>
                        <li>90度 = 正北</li>
                        <li>180度 = 正西</li>
                        <li>270度 = 正南</li>
                    </ul>
                </div>
                
                <div class="warning">
                    <strong>⚠️ 重要提示：</strong> 
                    <ul>
                        <li>方位角是本程序自定义的参数，用于确定进口道在交叉口图形中的位置，并非交通工程师通用参数。</li>
                    </ul>
                </div>
                
                <h3>3.2 4路交叉口数据说明</h3>
                <p>对于4路交叉口，流向列的含义如下：</p>
                <table class="table-example">
                    <tr>
                        <th>列名</th>
                        <th>说明</th>
                    </tr>
                    <tr>
                        <td>掉头</td>
                        <td>从该进口掉头返回的流量</td>
                    </tr>
                    <tr>
                        <td>左转</td>
                        <td>从该进口左转的流量</td>
                    </tr>
                    <tr>
                        <td>直行</td>
                        <td>从该进口直行的流量</td>
                    </tr>
                    <tr>
                        <td>右转</td>
                        <td>从该进口右转的流量</td>
                    </tr>
                </table>
                
                <h3>3.3 其他路数交叉口</h3>
                <p>对于3路、5路、6路交叉口，流向列使用通用格式：</p>
                <ul>
                    <li><strong>流线X_X</strong> - 掉头（从进口X回到出口X）</li>
                    <li><strong>流线X_X-1</strong> - 从进口X到出口X-1的流量</li>
                    <li><strong>流线X_X-2</strong> - 从进口X到出口X-2的流量</li>
                    <li>以此类推...</li>
                </ul>
            </div>
            
            <div class="section" id="draw">
                <h2>4. 绘制流量图</h2>
                
                <h3>4.1 绘制步骤</h3>
                <div class="step-box">
                    <h4>步骤1：输入数据</h4>
                    <p>在数据表格中输入各进口的名称、方位角和流向数据。</p>
                </div>
                
                <div class="step-box">
                    <h4>步骤2：点击"绘制流量图"</h4>
                    <p>点击主界面上的"绘制流量图"按钮，软件会自动生成流量图。</p>
                </div>
                
                <div class="step-box">
                    <h4>步骤3：查看结果</h4>
                    <p>流量图会在新窗口中显示，包含：</p>
                    <ul>
                        <li>各进口和出口的流量线（宽度表示流量大小）</li>
                        <li>各流向的路径（颜色对应进口颜色）</li>
                        <li>流量数值标注</li>
                        <li>道路名称标注</li>
                    </ul>
                </div>
                
                <h3>4.2 流量图说明</h3>
                <ul>
                    <li><strong>颜色</strong> - 每个进口使用不同颜色标识</li>
                    <li><strong>线宽</strong> - 线条宽度与流量大小成正比</li>
                    <li><strong>标注</strong> - 显示具体的流量数值</li>
                    <li><strong>路径</strong> - 显示车辆的实际行驶路径</li>
                </ul>
                
                <div class="warning">
                    <strong>⚠️ 注意：</strong> 如果数据不完整或格式错误，绘制可能会失败。请确保：
                    <ul>
                        <li>所有必填字段都已填写</li>
                        <li>数值格式正确（数字，可以为0）</li>
                        <li>方位角在0-360度范围内</li>
                        <li>如果绘图报错，尝试将方位角调大或调小1度</li>
                    </ul>
                </div>
            </div>
            
            <div class="section" id="file">
                <h2>5. 文件操作</h2>
                
                <h3>5.1 保存数据</h3>
                <p>点击"保存数据"按钮可以将当前数据保存到文件。文件格式为文本文件（.txt），使用UTF-8编码。</p>
                
                <h3>5.2 读取数据</h3>
                <p>点击"读取数据"按钮可以从文件加载数据。软件支持以下格式：</p>
                <ul>
                    <li>新格式：第一行包含"本交叉口为X路交叉口"声明</li>
                    <li>旧格式：兼容旧版本的数据格式</li>
                </ul>
                
                <h3>5.3 文件格式</h3>
                <p>数据文件格式示例（4路交叉口）：</p>
                <div class="step-box">
                    <code>
本交叉口为4路交叉口<br>
双龙大道,天元路,双龙大道,天元路<br>
0,90,180,270<br>
10,20,15,25<br>
50,60,55,65<br>
100,110,105,115<br>
30,40,35,45<br>
                    </code>
                </div>
                <p>文件说明：</p>
                <ol>
                    <li>第一行：交叉口路数声明</li>
                    <li>第二行：各进口名称（逗号分隔）</li>
                    <li>第三行：各进口方位角（逗号分隔）</li>
                    <li>后续行：各流向的流量数据（每行对应一个流向）</li>
                </ol>
                
                <div class="info">
                    <strong>💡 提示：</strong> 软件会自动检测文件编码，支持UTF-8、GBK、GB2312等多种编码格式。
                </div>
            </div>
            
            <div class="section" id="types">
                <h2>6. 交叉口类型说明</h2>
                
                <h3>6.1 3路交叉口</h3>
                <p>适用于T型或Y型交叉口，有3个进口和3个出口。</p>
                
                <h3>6.2 4路交叉口</h3>
                <p>最常见的十字交叉口，有4个进口和4个出口。流向包括：掉头、左转、直行、右转。</p>
                
                <h3>6.3 5路交叉口</h3>
                <p>五路交叉口，有5个进口和5个出口。适用于复杂的道路交叉口。</p>
                
                <h3>6.4 6路交叉口</h3>
                <p>六路交叉口，有6个进口和6个出口。适用于非常复杂的道路交叉口。</p>
                
                <div class="highlight">
                    <strong>💡 选择建议：</strong> 根据实际交叉口的道路数量选择对应的类型。如果选择错误，可以重新启动软件或读取正确的数据文件。
                </div>
            </div>
            
            <div class="section" id="faq">
                <h2>7. 常见问题</h2>
                
                <h3>Q1: 如何修改已输入的数据？</h3>
                <p><strong>A:</strong> 直接在数据表格中修改对应的单元格即可。修改后窗口标题会显示"未保存"提示。</p>
                
                <h3>Q2: 流量图显示不正常或报错怎么办？</h3>
                <p><strong>A:</strong> 请检查：</p>
                <ul>
                    <li>数据是否完整（所有必填字段都已填写）</li>
                    <li>数值格式是否正确（应为数字）</li>
                    <li>方位角是否在合理范围内（0-360度）</li>
                    <li><strong>如果绘图报错，尝试将方位角调大或调小1度</strong>，这通常可以解决角度计算问题</li>
                </ul>
                
                <h3>Q3: 可以导出流量图吗？</h3>
                <p><strong>A:</strong> 目前版本支持导出为svg、pdf、png、jpg、tif格式的流量图，推荐使用svg格式的矢量图。</p>
                
                <h3>Q4: 支持哪些数据格式？</h3>
                <p><strong>A:</strong> 软件支持文本文件（.txt）格式，使用逗号分隔值。支持UTF-8、GBK、GB2312等多种编码。</p>
                
                <h3>Q5: 如何计算方位角？</h3>
                <p><strong>A:</strong> 方位角是本程序自定义的参数，以正东方向为0度，逆时针增加：</p>
                <ul>
                    <li>0度 = 正东</li>
                    <li>90度 = 正北</li>
                    <li>180度 = 正西</li>
                    <li>270度 = 正南</li>
                </ul>
                <p>其他角度按此规律计算。如果绘图时出现错误，可以尝试将方位角调大或调小1度。</p>
                
                <h3>Q6: 流量可不可以输入0？</h3>
                <p><strong>A:</strong> 可以，软件支持输入0，空缺数据也会被视为0。0表示没有流量，不会在图上绘制，也不会标注。</p>
                
                <h3>Q7: 数据文件损坏怎么办？</h3>
                <p><strong>A:</strong> 软件会尝试多种编码格式读取文件。如果仍然失败，请检查文件格式是否正确，或重新创建数据文件。</p>
                
                <h3>Q8: 可以同时打开多个窗口吗？</h3>
                <p><strong>A:</strong> 可以多次点击"绘制流量图"按钮，每次都会打开新的流量图窗口。</p>
                
                <h3>Q9: 如何快速创建新的交叉口数据？</h3>
                <p><strong>A:</strong> 点击"新建文件"按钮，选择交叉口类型（3-6路），软件会自动创建新的数据表格并清空所有数据。</p>
                
                <h3>Q10: 如何快速清空所有数据？</h3>
                <p><strong>A:</strong> 点击"清空数据"按钮，确认后即可清空所有输入框的数据。注意：此操作不可撤销，请谨慎使用。</p>
            </div>
            
            <div class="section" id="update">
                <h2>8. 版本更新</h2>
                
                <h3>v1.3 更新内容（最新）</h3>
                <div class="info">
                    <ul>
                        <li><strong>新增功能</strong>：
                            <ul>
                                <li>出口宽度条箭头：在出口宽度条末端添加实心箭头，长度45单位，宽度为出口宽度条的1.8倍</li>
                                <li>延长进口宽度条：进口宽度条现在向外延长45单位</li>
                                <li>扩大绘图窗口：绘图窗口范围从(-330, 330)扩大到(-375, 375)</li>
                                <li>调整进口名称标签：进口名称标签沿方位角方向向外移动45单位</li>
                            </ul>
                        </li>
                        <li><strong>错误修复</strong>：
                            <ul>
                                <li>修复了启动界面关闭时的错误处理，现在能正确终止所有进程</li>
                            </ul>
                        </li>
                    </ul>
                </div>
                
                <h3>v1.2 更新内容</h3>
                <div class="info">
                    <ul>
                        <li><strong>错误修复</strong>：
                            <ul>
                                <li>修复了除0错误，提高了几何计算的稳定性</li>
                                <li>改进了无限斜率处理，避免平行线计算错误</li>
                                <li>优化了无限半径处理，防止圆弧绘制异常</li>
                                <li>增强了零长度向量归一化的安全检查</li>
                                <li>改进了浮点数比较，使用更精确的epsilon值</li>
                            </ul>
                        </li>
                        <li><strong>稳定性提升</strong>：程序在极端情况下（如平行线、重合点等）更加稳定，不会崩溃</li>
                    </ul>
                </div>
                
                <h3>v1.1 更新内容</h3>
                <div class="info">
                    <ul>
                        <li><strong>界面美化</strong>：采用现代化的扁平风格设计，优化颜色方案和布局</li>
                        <li><strong>字体优化</strong>：使用思源黑体/微软雅黑等更适合屏幕显示的字体，字体已嵌入程序</li>
                        <li><strong>窗口自适应</strong>：窗口大小会根据交叉口路数自动调整，完整显示所有输入框</li>
                        <li><strong>新增功能</strong>：
                            <ul>
                                <li>"新建文件"按钮：快速创建新的交叉口数据表格</li>
                                <li>"清空数据"按钮：一键清空所有输入框</li>
                            </ul>
                        </li>
                        <li><strong>方位角提示优化</strong>：添加了更详细的说明和报错解决方法</li>
                    </ul>
                </div>
                
                <h3>v1.0 初始版本</h3>
                <ul>
                    <li>支持3-6路交叉口流量绘制</li>
                    <li>数据文件的保存和读取</li>
                    <li>流量图导出功能（SVG、PDF、PNG等格式）</li>
                </ul>
            </div>
        </div>
        
        <div class="footer">
            <p><strong>交叉口交通流量流向可视化工具 v1.3</strong></p>
            <p>版权所有 (C) 江浦马保国 | 欢迎复制、传播本软件</p>
            <p>如有问题，请查看软件"关于"信息或联系开发者</p>
            <p style="margin-top: 10px; font-size: 0.9em; color: #999;">v1.3更新：新增出口箭头、延长进口条、扩大绘图窗口、修复启动界面关闭问题</p>
        </div>
    </div>
</body>
</html>

